<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>OVERVIEW OF SPATIAL STATISITCS</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="variogram_krigging_files/libs/clipboard/clipboard.min.js"></script>
<script src="variogram_krigging_files/libs/quarto-html/quarto.js"></script>
<script src="variogram_krigging_files/libs/quarto-html/popper.min.js"></script>
<script src="variogram_krigging_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="variogram_krigging_files/libs/quarto-html/anchor.min.js"></script>
<link href="variogram_krigging_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="variogram_krigging_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="variogram_krigging_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="variogram_krigging_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="variogram_krigging_files/libs/bootstrap/bootstrap-8e86427a6cc1d18ca4cd6587f8769fcf.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">OVERVIEW OF SPATIAL STATISITCS</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gstat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## load the meuse data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>meuse <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"meuse.csv"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>meause_grid <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"meuse.grid.csv"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="do">## convert to sf type</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>meuse <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(meuse,<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"x"</span>,<span class="st">"y"</span>))</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>meuse_grid <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(meause_grid,<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"x"</span>,<span class="st">"y"</span>))</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>meuse <span class="ot">&lt;-</span> meuse <span class="sc">|&gt;</span> </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_zinc =</span> <span class="fu">log</span>(zinc))</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(meuse) <span class="ot">&lt;-</span> <span class="dv">28992</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> meuse,<span class="fu">aes</span>(<span class="at">size =</span> zinc),<span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="variogram_krigging_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>vario <span class="ot">&lt;-</span> <span class="fu">variogram</span>(<span class="fu">log</span>(zinc) <span class="sc">~</span> <span class="fu">sqrt</span>(dist),<span class="at">data =</span> meuse)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>vario</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">np</th>
<th style="text-align: right;">dist</th>
<th style="text-align: right;">gamma</th>
<th style="text-align: right;">dir.hor</th>
<th style="text-align: right;">dir.ver</th>
<th style="text-align: left;">id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">57</td>
<td style="text-align: right;">79.29244</td>
<td style="text-align: right;">0.0881959</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">299</td>
<td style="text-align: right;">163.97367</td>
<td style="text-align: right;">0.1352367</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">419</td>
<td style="text-align: right;">267.36483</td>
<td style="text-align: right;">0.1471847</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">457</td>
<td style="text-align: right;">372.73542</td>
<td style="text-align: right;">0.1592972</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">547</td>
<td style="text-align: right;">478.47670</td>
<td style="text-align: right;">0.1793341</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">533</td>
<td style="text-align: right;">585.34058</td>
<td style="text-align: right;">0.1929815</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">574</td>
<td style="text-align: right;">693.14526</td>
<td style="text-align: right;">0.2375638</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">564</td>
<td style="text-align: right;">796.18365</td>
<td style="text-align: right;">0.2549548</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">589</td>
<td style="text-align: right;">903.14650</td>
<td style="text-align: right;">0.2400306</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">543</td>
<td style="text-align: right;">1011.29177</td>
<td style="text-align: right;">0.2477801</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">500</td>
<td style="text-align: right;">1117.86235</td>
<td style="text-align: right;">0.2253489</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">477</td>
<td style="text-align: right;">1221.32810</td>
<td style="text-align: right;">0.2038346</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">452</td>
<td style="text-align: right;">1329.16407</td>
<td style="text-align: right;">0.2046200</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">457</td>
<td style="text-align: right;">1437.25620</td>
<td style="text-align: right;">0.1798083</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">415</td>
<td style="text-align: right;">1543.20248</td>
<td style="text-align: right;">0.1803123</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>vario_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(vario)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>vario_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">np</th>
<th style="text-align: right;">dist</th>
<th style="text-align: right;">gamma</th>
<th style="text-align: right;">dir.hor</th>
<th style="text-align: right;">dir.ver</th>
<th style="text-align: left;">id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">57</td>
<td style="text-align: right;">79.29244</td>
<td style="text-align: right;">0.0881959</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">299</td>
<td style="text-align: right;">163.97367</td>
<td style="text-align: right;">0.1352367</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">419</td>
<td style="text-align: right;">267.36483</td>
<td style="text-align: right;">0.1471847</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">457</td>
<td style="text-align: right;">372.73542</td>
<td style="text-align: right;">0.1592972</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">547</td>
<td style="text-align: right;">478.47670</td>
<td style="text-align: right;">0.1793341</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">533</td>
<td style="text-align: right;">585.34058</td>
<td style="text-align: right;">0.1929815</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">574</td>
<td style="text-align: right;">693.14526</td>
<td style="text-align: right;">0.2375638</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">564</td>
<td style="text-align: right;">796.18365</td>
<td style="text-align: right;">0.2549548</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">589</td>
<td style="text-align: right;">903.14650</td>
<td style="text-align: right;">0.2400306</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">543</td>
<td style="text-align: right;">1011.29177</td>
<td style="text-align: right;">0.2477801</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">500</td>
<td style="text-align: right;">1117.86235</td>
<td style="text-align: right;">0.2253489</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">477</td>
<td style="text-align: right;">1221.32810</td>
<td style="text-align: right;">0.2038346</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">452</td>
<td style="text-align: right;">1329.16407</td>
<td style="text-align: right;">0.2046200</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">457</td>
<td style="text-align: right;">1437.25620</td>
<td style="text-align: right;">0.1798083</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">415</td>
<td style="text-align: right;">1543.20248</td>
<td style="text-align: right;">0.1803123</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>vario_df <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> dist, <span class="at">y=</span> gamma))<span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>,<span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>,<span class="at">linewidth =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="variogram_krigging_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>vario_meuse <span class="ot">&lt;-</span> <span class="fu">variogram</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(zinc)<span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> meuse,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">2000</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">50</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>vario_meuse</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">np</th>
<th style="text-align: right;">dist</th>
<th style="text-align: right;">gamma</th>
<th style="text-align: right;">dir.hor</th>
<th style="text-align: right;">dir.ver</th>
<th style="text-align: left;">id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">46.58803</td>
<td style="text-align: right;">0.0353952</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">50</td>
<td style="text-align: right;">78.23622</td>
<td style="text-align: right;">0.1337488</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">114</td>
<td style="text-align: right;">130.59003</td>
<td style="text-align: right;">0.1548947</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">149</td>
<td style="text-align: right;">175.85374</td>
<td style="text-align: right;">0.2505998</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">179</td>
<td style="text-align: right;">225.80141</td>
<td style="text-align: right;">0.2506857</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">202</td>
<td style="text-align: right;">275.36349</td>
<td style="text-align: right;">0.3345743</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">196</td>
<td style="text-align: right;">324.52574</td>
<td style="text-align: right;">0.3027866</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">234</td>
<td style="text-align: right;">373.77160</td>
<td style="text-align: right;">0.4510947</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">241</td>
<td style="text-align: right;">426.97020</td>
<td style="text-align: right;">0.3881716</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">234</td>
<td style="text-align: right;">473.33397</td>
<td style="text-align: right;">0.4957476</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">273</td>
<td style="text-align: right;">524.41232</td>
<td style="text-align: right;">0.5158092</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">230</td>
<td style="text-align: right;">574.65632</td>
<td style="text-align: right;">0.5276830</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">269</td>
<td style="text-align: right;">623.56515</td>
<td style="text-align: right;">0.5812346</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">256</td>
<td style="text-align: right;">675.55753</td>
<td style="text-align: right;">0.5213266</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">289</td>
<td style="text-align: right;">725.03818</td>
<td style="text-align: right;">0.6369187</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">276</td>
<td style="text-align: right;">774.85617</td>
<td style="text-align: right;">0.5928021</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">250</td>
<td style="text-align: right;">824.62673</td>
<td style="text-align: right;">0.6562485</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">285</td>
<td style="text-align: right;">874.80784</td>
<td style="text-align: right;">0.6952111</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">269</td>
<td style="text-align: right;">924.18021</td>
<td style="text-align: right;">0.6144743</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">261</td>
<td style="text-align: right;">976.66109</td>
<td style="text-align: right;">0.6743949</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">261</td>
<td style="text-align: right;">1026.29216</td>
<td style="text-align: right;">0.6878749</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">226</td>
<td style="text-align: right;">1074.50192</td>
<td style="text-align: right;">0.6935528</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">234</td>
<td style="text-align: right;">1124.81382</td>
<td style="text-align: right;">0.6908380</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">249</td>
<td style="text-align: right;">1175.25529</td>
<td style="text-align: right;">0.6524152</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">220</td>
<td style="text-align: right;">1224.11624</td>
<td style="text-align: right;">0.6462620</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">211</td>
<td style="text-align: right;">1275.96599</td>
<td style="text-align: right;">0.6041302</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">217</td>
<td style="text-align: right;">1324.70343</td>
<td style="text-align: right;">0.6265594</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">202</td>
<td style="text-align: right;">1374.58503</td>
<td style="text-align: right;">0.6423884</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">208</td>
<td style="text-align: right;">1424.88854</td>
<td style="text-align: right;">0.5379728</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">219</td>
<td style="text-align: right;">1473.54229</td>
<td style="text-align: right;">0.5897533</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">181</td>
<td style="text-align: right;">1523.15682</td>
<td style="text-align: right;">0.5932250</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">205</td>
<td style="text-align: right;">1572.20864</td>
<td style="text-align: right;">0.5615295</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">209</td>
<td style="text-align: right;">1624.70309</td>
<td style="text-align: right;">0.5466246</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">185</td>
<td style="text-align: right;">1675.09342</td>
<td style="text-align: right;">0.5758046</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">196</td>
<td style="text-align: right;">1724.09994</td>
<td style="text-align: right;">0.5541065</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">181</td>
<td style="text-align: right;">1774.39835</td>
<td style="text-align: right;">0.5490103</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">206</td>
<td style="text-align: right;">1824.32827</td>
<td style="text-align: right;">0.5051386</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">163</td>
<td style="text-align: right;">1874.35650</td>
<td style="text-align: right;">0.4757967</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">187</td>
<td style="text-align: right;">1924.74565</td>
<td style="text-align: right;">0.5146637</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
<tr class="even">
<td style="text-align: right;">151</td>
<td style="text-align: right;">1973.51812</td>
<td style="text-align: right;">0.5052481</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">var1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>vario_meuse_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(vario_meuse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vario_meuse_df, <span class="fu">aes</span>(<span class="at">x =</span> dist, <span class="at">y =</span> gamma)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"darkgreen"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"darkgreen"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Empirical Variogram of Log Zinc"</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Distance (m)"</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Semivariance"</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="variogram_krigging_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>vgm_model <span class="ot">&lt;-</span> <span class="fu">fit.variogram</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> vario_meuse,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> <span class="fu">vgm</span>(<span class="at">psill =</span> <span class="fl">0.7</span>,<span class="at">model =</span> <span class="st">"Exp"</span>,<span class="at">nugget =</span> <span class="fl">0.1</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>vgm_line <span class="ot">=</span> <span class="fu">variogramLine</span>(vgm_model,<span class="at">maxdist =</span> <span class="fu">max</span>(vario_meuse[[<span class="st">"dist"</span>]]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>vario_meuse_df <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> dist, <span class="at">y =</span> gamma))<span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"darkgreen"</span>) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"darkgreen"</span>) <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> vgm_line, <span class="fu">aes</span>(<span class="at">x =</span> dist, <span class="at">y =</span> gamma), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Empirical and Fitted Variogram"</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Distance (m)"</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Semivariance"</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="variogram_krigging_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vgm_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  model     psill    range
1   Nug 0.0000000   0.0000
2   Exp 0.6876192 424.1934</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Exp"</span>,<span class="st">"Sph"</span>,<span class="st">"Gau"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>vgm_fits <span class="ot">&lt;-</span> <span class="fu">map</span>(models, <span class="sc">~</span><span class="fu">fit.variogram</span>(</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> vario_meuse,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> <span class="fu">vgm</span>(<span class="at">psill =</span> <span class="fl">0.7</span>,<span class="at">model =</span> <span class="st">"Exp"</span>,<span class="at">nugget =</span> <span class="fl">0.1</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(vgm_fits) <span class="ot">&lt;-</span> models</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>vgm_fits</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Exp
  model     psill    range
1   Nug 0.0000000   0.0000
2   Exp 0.6876192 424.1934

$Sph
  model     psill    range
1   Nug 0.0000000   0.0000
2   Exp 0.6876192 424.1934

$Gau
  model     psill    range
1   Nug 0.0000000   0.0000
2   Exp 0.6876192 424.1934</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>model_lines <span class="ot">&lt;-</span> <span class="fu">imap_dfr</span>(vgm_fits, <span class="sc">~</span> {</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">variogramLine</span>(.x, <span class="at">maxdist =</span> <span class="fu">max</span>(vario_meuse[[<span class="st">"dist"</span>]])) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">model =</span> .y)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>model_lines <span class="ot">&lt;-</span> model_lines <span class="sc">|&gt;</span> </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">factor</span>(model))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> vario_meuse_df, <span class="fu">aes</span>(<span class="at">x =</span> dist, <span class="at">y =</span> gamma), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> vario_meuse_df, <span class="fu">aes</span>(<span class="at">x =</span> dist, <span class="at">y =</span> gamma), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> model_lines, <span class="fu">aes</span>(<span class="at">x =</span> dist, <span class="at">y =</span> gamma, <span class="at">color =</span> model, <span class="at">linetype =</span> model), <span class="at">linewidth =</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Exp"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Gau"</span> <span class="ot">=</span> <span class="st">"forestgreen"</span>, <span class="st">"Sph"</span> <span class="ot">=</span> <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Exp"</span> <span class="ot">=</span> <span class="st">"solid"</span>, <span class="st">"Gau"</span> <span class="ot">=</span> <span class="st">"dashed"</span>, <span class="st">"Sph"</span> <span class="ot">=</span> <span class="st">"dotdash"</span>)) <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Empirical and Fitted Variogram Models"</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Distance (m)"</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Semivariance"</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Model"</span>,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"Model"</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="variogram_krigging_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>cv_results <span class="ot">&lt;-</span> <span class="fu">imap_dfr</span>(vgm_fits, <span class="sc">~</span> {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  cv <span class="ot">&lt;-</span> <span class="fu">krige.cv</span>(log_zinc <span class="sc">~</span> <span class="dv">1</span>, meuse, <span class="at">model =</span> .x)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">model =</span> .y,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMSE =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(cv<span class="sc">$</span>residual<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">ME =</span> <span class="fu">mean</span>(cv<span class="sc">$</span>residual),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">MAE =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(cv<span class="sc">$</span>residual))</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>cv_results <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(RMSE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: right;">RMSE</th>
<th style="text-align: right;">ME</th>
<th style="text-align: right;">MAE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Exp</td>
<td style="text-align: right;">0.3941106</td>
<td style="text-align: right;">0.0020238</td>
<td style="text-align: right;">0.2922564</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sph</td>
<td style="text-align: right;">0.3941106</td>
<td style="text-align: right;">0.0020238</td>
<td style="text-align: right;">0.2922564</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gau</td>
<td style="text-align: right;">0.3941106</td>
<td style="text-align: right;">0.0020238</td>
<td style="text-align: right;">0.2922564</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<section id="krigging" class="level3">
<h3 class="anchored" data-anchor-id="krigging">Krigging</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(meuse) <span class="ot">&lt;-</span> <span class="dv">28992</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(meuse_grid) <span class="ot">&lt;-</span> <span class="dv">28992</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>best_model <span class="ot">&lt;-</span> vgm_fits[[<span class="st">"Sph"</span>]]</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>best_model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: right;">psill</th>
<th style="text-align: right;">range</th>
<th style="text-align: right;">kappa</th>
<th style="text-align: right;">ang1</th>
<th style="text-align: right;">ang2</th>
<th style="text-align: right;">ang3</th>
<th style="text-align: right;">anis1</th>
<th style="text-align: right;">anis2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Nug</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Exp</td>
<td style="text-align: right;">0.6876192</td>
<td style="text-align: right;">424.1934</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>kriged <span class="ot">&lt;-</span> <span class="fu">krige</span>(<span class="fu">log</span>(zinc) <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">locations =</span>  meuse,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">newdata=</span> meuse_grid, </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">model =</span> best_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[using ordinary kriging]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>kriged_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(kriged)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#spplot(kriged["var1.pred"], main = "Kriged Prediction: Log Zinc")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>kriged_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(kriged)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(kriged_sf) <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">color =</span> var1.pred)) <span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">name =</span> <span class="st">"Log-Zinc (Kriged)"</span>) <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="variogram_krigging_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> meuse,<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">log</span>(zinc)))<span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_viridis_c</span>(<span class="at">name =</span> <span class="st">"Log-Zinc (Kriged)"</span>) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="variogram_krigging_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>kriged_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(kriged)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(kriged_sf) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">color =</span> var1.var),<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> meuse,<span class="at">color =</span> <span class="st">"black"</span>,<span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">name =</span> <span class="st">"Log-Zinc (Kriged)"</span>,<span class="at">option =</span> <span class="st">"inferno"</span>) <span class="sc">+</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="variogram_krigging_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="linear-and-non-linear-trends-in-space" class="level3">
<h3 class="anchored" data-anchor-id="linear-and-non-linear-trends-in-space">Linear and Non-linear Trends in Space</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="do">## extract coordinates</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>meuse <span class="ot">&lt;-</span> meuse <span class="sc">%&gt;%</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">st_coordinates</span>(.)[,<span class="dv">1</span>],</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="fu">st_coordinates</span>(.)[,<span class="dv">2</span>])</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>meuse_grid <span class="ot">&lt;-</span> meuse_grid <span class="sc">%&gt;%</span> </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">st_coordinates</span>(.)[,<span class="dv">1</span>],</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="fu">st_coordinates</span>(.)[,<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>meuse <span class="sc">|&gt;</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="fu">log</span>(zinc)))<span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Longitude"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="variogram_krigging_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>meuse <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> y, <span class="at">y =</span> <span class="fu">log</span>(zinc)))<span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x =</span> <span class="st">"Latitude"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="variogram_krigging_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="do">## extract coordinates</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>meuse <span class="ot">&lt;-</span> meuse <span class="sc">%&gt;%</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">st_coordinates</span>(.)[,<span class="dv">1</span>],</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="fu">st_coordinates</span>(.)[,<span class="dv">2</span>])</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>meuse_grid <span class="ot">&lt;-</span> meuse_grid <span class="sc">%&gt;%</span> </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">st_coordinates</span>(.)[,<span class="dv">1</span>],</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="fu">st_coordinates</span>(.)[,<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="do">## linear trend</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>vgm_uk_lin <span class="ot">&lt;-</span> <span class="fu">variogram</span>(<span class="fu">log</span>(zinc) <span class="sc">~</span> x <span class="sc">+</span> y <span class="sc">+</span> <span class="fu">sqrt</span>(dist), meuse)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>vgm_uk_lin_fit <span class="ot">&lt;-</span> <span class="fu">fit.variogram</span>(vgm_uk_lin, <span class="at">model =</span> <span class="fu">vgm</span>(<span class="fl">0.6</span>, <span class="st">"Sph"</span>, <span class="dv">900</span>, <span class="fl">0.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="do">## polynomial trend</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>vgm_uk_poly <span class="ot">&lt;-</span> <span class="fu">variogram</span>(<span class="fu">log</span>(zinc) <span class="sc">~</span> <span class="fu">poly</span>(x,<span class="dv">2</span>) <span class="sc">+</span> <span class="fu">poly</span>(y,<span class="dv">2</span>) <span class="sc">+</span> <span class="fu">sqrt</span>(dist), meuse)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>vgm_uk_poly_fit <span class="ot">&lt;-</span>  <span class="fu">fit.variogram</span>(vgm_uk_poly, <span class="at">model =</span> <span class="fu">vgm</span>(<span class="fl">0.6</span>, <span class="st">"Sph"</span>, <span class="dv">900</span>, <span class="fl">0.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="do">## # Includes interaction term for full quadratic surface</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>vgm_full_poly_surf <span class="ot">&lt;-</span> <span class="fu">variogram</span>(<span class="fu">log</span>(zinc) <span class="sc">~</span> x <span class="sc">+</span> y <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(y<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">*</span> y) <span class="sc">+</span> <span class="fu">sqrt</span>(dist),<span class="at">data =</span> meuse)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>vgm_full_poly_surf_fit <span class="ot">&lt;-</span> <span class="fu">fit.variogram</span>(vgm_full_poly_surf, <span class="at">model =</span> <span class="fu">vgm</span>(<span class="fl">0.6</span>, <span class="st">"Sph"</span>, <span class="dv">900</span>, <span class="fl">0.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>kriged_uk_poly <span class="ot">&lt;-</span> <span class="fu">krige</span>(<span class="fu">log</span>(zinc) <span class="sc">~</span> <span class="fu">poly</span>(x,<span class="dv">2</span>) <span class="sc">+</span> <span class="fu">poly</span>(y,<span class="dv">2</span>) <span class="sc">+</span> <span class="fu">sqrt</span>(dist),</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">locations =</span> meuse,</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">newdata =</span> meuse_grid,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">model =</span> vgm_uk_lin_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[using universal kriging]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">st_as_sf</span>(kriged_uk_poly)) <span class="sc">+</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">color =</span> var1.pred)) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">name =</span> <span class="st">"Kriged log(zinc)</span><span class="sc">\n</span><span class="st">(with trend)"</span>) <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="variogram_krigging_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="test-polynomial-degrees-of-spatial-trend" class="level3">
<h3 class="anchored" data-anchor-id="test-polynomial-degrees-of-spatial-trend">Test Polynomial Degrees of Spatial Trend</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Degree 1 (linear)</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>uk_formula1 <span class="ot">&lt;-</span> <span class="fu">log</span>(zinc) <span class="sc">~</span> x <span class="sc">+</span> y <span class="sc">+</span>  <span class="fu">sqrt</span>(dist)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Degree 2 (quadratic)</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>uk_formula2 <span class="ot">&lt;-</span> <span class="fu">log</span>(zinc) <span class="sc">~</span> x <span class="sc">+</span> y <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(y<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">*</span> y) <span class="sc">+</span>  <span class="fu">sqrt</span>(dist)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Degree 3 (cubic)</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co">#uk_formula3 &lt;- log(zinc) ~ poly(x, 3) + poly(y, 3) + sqrt(dist)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Ordinary =</span> <span class="fu">log</span>(zinc) <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Poly1 =</span> uk_formula1,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Poly2 =</span> uk_formula2</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>kriging_results <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">imap_dfr</span>(formulas, <span class="cf">function</span>(formula, name) {</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  vgm_emp <span class="ot">&lt;-</span> <span class="fu">variogram</span>(formula, meuse)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  vgm_fit <span class="ot">&lt;-</span> <span class="fu">fit.variogram</span>(vgm_emp, <span class="at">model =</span> <span class="fu">vgm</span>(<span class="fl">0.6</span>, <span class="st">"Sph"</span>, <span class="dv">900</span>, <span class="fl">0.1</span>))</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  cv <span class="ot">&lt;-</span> <span class="fu">krige.cv</span>(formula, meuse, <span class="at">model =</span> vgm_fit)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">model =</span> name,</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMSE =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(cv<span class="sc">$</span>residual<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">MAE =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(cv<span class="sc">$</span>residual)),</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">ME =</span> <span class="fu">mean</span>(cv<span class="sc">$</span>residual)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>kriging_results <span class="sc">|&gt;</span> </span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(RMSE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: right;">RMSE</th>
<th style="text-align: right;">MAE</th>
<th style="text-align: right;">ME</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Poly1</td>
<td style="text-align: right;">0.3750314</td>
<td style="text-align: right;">0.2691346</td>
<td style="text-align: right;">-0.0028171</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ordinary</td>
<td style="text-align: right;">0.3918052</td>
<td style="text-align: right;">0.2921531</td>
<td style="text-align: right;">-0.0000209</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Poly2</td>
<td style="text-align: right;">0.3960924</td>
<td style="text-align: right;">0.2760628</td>
<td style="text-align: right;">-0.0077219</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(kriging_results, <span class="at">digits =</span> <span class="dv">4</span>, <span class="at">caption =</span> <span class="st">"Cross-Validation Results for Kriging Models"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Cross-Validation Results for Kriging Models</caption>
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: right;">RMSE</th>
<th style="text-align: right;">MAE</th>
<th style="text-align: right;">ME</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ordinary</td>
<td style="text-align: right;">0.3918</td>
<td style="text-align: right;">0.2922</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Poly1</td>
<td style="text-align: right;">0.3750</td>
<td style="text-align: right;">0.2691</td>
<td style="text-align: right;">-0.0028</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Poly2</td>
<td style="text-align: right;">0.3961</td>
<td style="text-align: right;">0.2761</td>
<td style="text-align: right;">-0.0077</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>cv_best <span class="ot">&lt;-</span> <span class="fu">krige.cv</span>(uk_formula2, meuse, <span class="at">model =</span> <span class="fu">fit.variogram</span>(<span class="fu">variogram</span>(uk_formula2, meuse), <span class="fu">vgm</span>(<span class="fl">0.6</span>, <span class="st">"Sph"</span>, <span class="dv">900</span>, <span class="fl">0.1</span>)))</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">obs =</span> cv_best<span class="sc">$</span>observed, <span class="at">pred =</span> cv_best<span class="sc">$</span>var1.pred), <span class="fu">aes</span>(<span class="at">x =</span> obs, <span class="at">y =</span> pred)) <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Observed vs Predicted (Universal Kriging, Poly2)"</span>,</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Observed"</span>, <span class="at">y =</span> <span class="st">"Predicted"</span>) <span class="sc">+</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="variogram_krigging_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="geostatistical_spartial-regression" class="level3">
<h3 class="anchored" data-anchor-id="geostatistical_spartial-regression">Geostatistical_Spartial Regression</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spatialreg)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spdep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>meuse<span class="sc">$</span>sqrt_dist <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(meuse<span class="sc">$</span>dist.m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="do">## convert sf to sp for spatialreg</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>meuse_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(meuse, <span class="st">"Spatial"</span>)  <span class="co"># converts sf to SpatialPointsDataFrame</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Now this works:</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>nb <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(<span class="fu">coordinates</span>(meuse_sp), <span class="at">k =</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="do">## create spatial weights matrix</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Find neighbors using k-nearest (k=5 is common)</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>nb <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(<span class="fu">coordinates</span>(meuse_sp), <span class="at">k =</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="do">## if you don't want to convert</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(meuse)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>nb <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords, <span class="at">k =</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Row-standardized spatial weights</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spdep)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>lw <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(nb, <span class="at">style =</span> <span class="st">"W"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nb,coords)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="variogram_krigging_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Spatial Lag Models (SAR)</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>lag_model <span class="ot">&lt;-</span> <span class="fu">lagsarlm</span>(<span class="fu">log</span>(zinc) <span class="sc">~</span>  sqrt_dist, <span class="at">data =</span> meuse_sp, <span class="at">listw =</span> lw)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lag_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:lagsarlm(formula = log(zinc) ~ sqrt_dist, data = meuse_sp, listw = lw)

Residuals:
      Min        1Q    Median        3Q       Max 
-1.101033 -0.203614 -0.035896  0.220012  1.697324 

Type: lag 
Coefficients: (asymptotic standard errors) 
              Estimate Std. Error z value  Pr(&gt;|z|)
(Intercept)  4.6744833  0.5928750  7.8844 3.109e-15
sqrt_dist   -0.0583588  0.0071385 -8.1752 2.220e-16

Rho: 0.35899, LR test value: 15.04, p-value: 0.00010523
Asymptotic standard error: 0.085708
    z-value: 4.1885, p-value: 2.8084e-05
Wald statistic: 17.543, p-value: 2.8084e-05

Log likelihood: -84.37743 for lag model
ML residual variance (sigma squared): 0.16988, (sigma: 0.41217)
Number of observations: 155 
Number of parameters estimated: 4 
AIC: 176.75, (AIC for lm: 189.8)
LM test for residual autocorrelation
test value: 7.9283, p-value: 0.0048668</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Spatial Error Model</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>error_model <span class="ot">&lt;-</span> <span class="fu">errorsarlm</span>(<span class="fu">log</span>(zinc) <span class="sc">~</span>   sqrt_dist, <span class="at">data =</span> meuse_sp, <span class="at">listw =</span> lw)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(error_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:errorsarlm(formula = log(zinc) ~ sqrt_dist, data = meuse_sp, 
    listw = lw)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.963624 -0.228735 -0.024474  0.209563  1.730036 

Type: error 
Coefficients: (asymptotic standard errors) 
              Estimate Std. Error z value  Pr(&gt;|z|)
(Intercept)  7.1234814  0.1172256  60.767 &lt; 2.2e-16
sqrt_dist   -0.0811228  0.0066182 -12.258 &lt; 2.2e-16

Lambda: 0.47195, LR test value: 21.935, p-value: 2.8198e-06
Asymptotic standard error: 0.094532
    z-value: 4.9925, p-value: 5.9612e-07
Wald statistic: 24.925, p-value: 5.9612e-07

Log likelihood: -80.92995 for error model
ML residual variance (sigma squared): 0.15931, (sigma: 0.39914)
Number of observations: 155 
Number of parameters estimated: 4 
AIC: 169.86, (AIC for lm: 189.8)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="do">###  Spatial Durbin Model (includes spatial lags of predictors)</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>durbin_model <span class="ot">&lt;-</span> <span class="fu">lagsarlm</span>(<span class="fu">log</span>(zinc) <span class="sc">~</span>  sqrt_dist, <span class="at">data =</span> meuse_sp, <span class="at">listw =</span> lw, <span class="at">type =</span> <span class="st">"mixed"</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(durbin_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:lagsarlm(formula = log(zinc) ~ sqrt_dist, data = meuse_sp, listw = lw, 
    type = "mixed")

Residuals:
      Min        1Q    Median        3Q       Max 
-0.961603 -0.230939 -0.022294  0.207555  1.729959 

Type: mixed 
Coefficients: (asymptotic standard errors) 
               Estimate Std. Error z value  Pr(&gt;|z|)
(Intercept)    3.762040   0.679571  5.5359 3.096e-08
sqrt_dist     -0.081716   0.010851 -7.5306 5.040e-14
lag.sqrt_dist  0.039113   0.015193  2.5745   0.01004

Rho: 0.47122, LR test value: 21.709, p-value: 3.1734e-06
Asymptotic standard error: 0.094614
    z-value: 4.9804, p-value: 6.345e-07
Wald statistic: 24.804, p-value: 6.345e-07

Log likelihood: -80.92756 for mixed model
ML residual variance (sigma squared): 0.15933, (sigma: 0.39916)
Number of observations: 155 
Number of parameters estimated: 5 
AIC: 171.86, (AIC for lm: 191.56)
LM test for residual autocorrelation
test value: 1.19, p-value: 0.27533</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Model Comparison</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(lag_model, error_model, durbin_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">AIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">lag_model</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">176.7549</td>
</tr>
<tr class="even">
<td style="text-align: left;">error_model</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">169.8599</td>
</tr>
<tr class="odd">
<td style="text-align: left;">durbin_model</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">171.8551</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>(<span class="fu">residuals</span>(lag_model)<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4121652</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>(<span class="fu">residuals</span>(error_model)<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3991359</code></pre>
</div>
</div>
<section id="bayesian-spatial-regression" class="level4">
<h4 class="anchored" data-anchor-id="bayesian-spatial-regression">Bayesian Spatial Regression</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(INLA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>lyme_data <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"nys_lyme_data.rds"</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>nyc <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"Counties.shp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `Counties' from data source 
  `C:\Users\KAsab\Desktop\SPATIAL STATISTICS\Counties.shp' using driver `ESRI Shapefile'
Simple feature collection with 62 features and 17 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 105571.4 ymin: 4480943 xmax: 779932.1 ymax: 4985476
Projected CRS: NAD83 / UTM zone 18N</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spdep)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create neighborhood structure</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>nb <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(<span class="fu">st_geometry</span>(lyme_data))  <span class="co"># meuse_sf must be polygon-based</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="co">#g &lt;- inla.read.graph(nb2INLA(nb))     # convert nb object to INLA graph</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(lyme_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 62
Columns: 9
$ NAME                &lt;chr&gt; "Albany", "Allegany", "Bronx", "Broome", "Cattarau
$ FIPS_CODE           &lt;chr&gt; "36001", "36003", "36005", "36007", "36009", "3601
$ Health.Topic        &lt;chr&gt; "Communicable Disease Indicators", "Communicable D
$ Indicator           &lt;chr&gt; "Lyme disease incidence per 100,000", "Lyme diseas
$ Measure.Unit        &lt;chr&gt; "Rate", "Rate", "Rate", "Rate", "Rate", "Rate", "R
$ Lyme.Incidence.Rate &lt;dbl&gt; 71.5, 7.7, 3.4, 109.8, 12.4, 10.6, 3.1, 71.2, 98.1
$ Data.Years          &lt;chr&gt; "2014-2016", "2014-2016", "2014-2016", "2014-2016"
$ Data.Source         &lt;chr&gt; "Bureau of Communicable Disease Control Data as of
$ geometry            &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((605729 4737..., MULTI</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>scag_region <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"pysal/scag_region.gpkg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `tracts' from data source 
  `C:\Users\KAsab\Desktop\SPATIAL STATISTICS\pysal\scag_region.gpkg' 
  using driver `GPKG'
Simple feature collection with 4580 features and 193 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -119.5788 ymin: 32.53416 xmax: -114.1312 ymax: 35.80963
Geodetic CRS:  WGS 84</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(scag_region)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="variogram_krigging_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(scag_region)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sf"         "data.frame"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> nyc,<span class="at">fill =</span> <span class="st">"grey95"</span>)<span class="sc">+</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"New York City Counties"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="variogram_krigging_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_geometry</span>(nyc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Geometry set for 62 features 
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 105571.4 ymin: 4480943 xmax: 779932.1 ymax: 4985476
Projected CRS: NAD83 / UTM zone 18N
First 5 geometries:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_geometry</span>(lyme_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Geometry set for 62 features 
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 105571.4 ymin: 4480943 xmax: 779932.1 ymax: 4985476
Projected CRS: NAD83 / UTM zone 18N
First 5 geometries:</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>nys_lyme_data <span class="ot">&lt;-</span> lyme_data <span class="sc">|&gt;</span> </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Lyme.Incidence.Rate))</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>nyc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 2%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">NAME</th>
<th style="text-align: left;">ABBREV</th>
<th style="text-align: left;">GNIS_ID</th>
<th style="text-align: left;">FIPS_CODE</th>
<th style="text-align: left;">SWIS</th>
<th style="text-align: left;">NYSP_ZONE</th>
<th style="text-align: right;">POP1990</th>
<th style="text-align: right;">POP2000</th>
<th style="text-align: right;">POP2010</th>
<th style="text-align: right;">POP2020</th>
<th style="text-align: left;">DOS_LL</th>
<th style="text-align: left;">DOSLL_DATE</th>
<th style="text-align: left;">NYC</th>
<th style="text-align: right;">CALC_SQ_MI</th>
<th style="text-align: left;">DATEMOD</th>
<th style="text-align: right;">Shape_Leng</th>
<th style="text-align: right;">Shape_Area</th>
<th style="text-align: left;">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Albany</td>
<td style="text-align: left;">ALBA</td>
<td style="text-align: left;">974099</td>
<td style="text-align: left;">36001</td>
<td style="text-align: left;">010000</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">292594</td>
<td style="text-align: right;">294565</td>
<td style="text-align: right;">304204</td>
<td style="text-align: right;">314848</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">532.79178</td>
<td style="text-align: left;">2017-11-10</td>
<td style="text-align: right;">166077.83</td>
<td style="text-align: right;">1379924372</td>
<td style="text-align: left;">MULTIPOLYGON (((605729 4737</td>
</tr>
<tr class="even">
<td style="text-align: left;">Allegany</td>
<td style="text-align: left;">ALLE</td>
<td style="text-align: left;">974100</td>
<td style="text-align: left;">36003</td>
<td style="text-align: left;">020000</td>
<td style="text-align: left;">West</td>
<td style="text-align: right;">50470</td>
<td style="text-align: right;">49927</td>
<td style="text-align: right;">48946</td>
<td style="text-align: right;">46456</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">1035.20913</td>
<td style="text-align: left;">2019-04-26</td>
<td style="text-align: right;">210499.34</td>
<td style="text-align: right;">2681179340</td>
<td style="text-align: left;">MULTIPOLYGON (((229573.9 47</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bronx</td>
<td style="text-align: left;">BRON</td>
<td style="text-align: left;">974101</td>
<td style="text-align: left;">36005</td>
<td style="text-align: left;">600000</td>
<td style="text-align: left;">Long Island</td>
<td style="text-align: right;">1203789</td>
<td style="text-align: right;">1332650</td>
<td style="text-align: right;">1385108</td>
<td style="text-align: right;">1472654</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Y</td>
<td style="text-align: right;">57.47215</td>
<td style="text-align: left;">2019-10-04</td>
<td style="text-align: right;">57253.86</td>
<td style="text-align: right;">148852180</td>
<td style="text-align: left;">MULTIPOLYGON (((595540.7 45</td>
</tr>
<tr class="even">
<td style="text-align: left;">Broome</td>
<td style="text-align: left;">BROO</td>
<td style="text-align: left;">974102</td>
<td style="text-align: left;">36007</td>
<td style="text-align: left;">030000</td>
<td style="text-align: left;">Central</td>
<td style="text-align: right;">212160</td>
<td style="text-align: right;">200536</td>
<td style="text-align: right;">200600</td>
<td style="text-align: right;">198683</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">715.28747</td>
<td style="text-align: left;">2019-04-26</td>
<td style="text-align: right;">227933.33</td>
<td style="text-align: right;">1852586030</td>
<td style="text-align: left;">MULTIPOLYGON (((428899.3 46</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cattaraugus</td>
<td style="text-align: left;">CATT</td>
<td style="text-align: left;">974103</td>
<td style="text-align: left;">36009</td>
<td style="text-align: left;">040000</td>
<td style="text-align: left;">West</td>
<td style="text-align: right;">84234</td>
<td style="text-align: right;">83955</td>
<td style="text-align: right;">80317</td>
<td style="text-align: right;">77042</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">1324.30922</td>
<td style="text-align: left;">2019-04-26</td>
<td style="text-align: right;">276084.51</td>
<td style="text-align: right;">3429945130</td>
<td style="text-align: left;">MULTIPOLYGON (((169747.3 47</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cayuga</td>
<td style="text-align: left;">CAYU</td>
<td style="text-align: left;">974104</td>
<td style="text-align: left;">36011</td>
<td style="text-align: left;">050000</td>
<td style="text-align: left;">Central</td>
<td style="text-align: right;">82313</td>
<td style="text-align: right;">81963</td>
<td style="text-align: right;">80026</td>
<td style="text-align: right;">76248</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">881.82350</td>
<td style="text-align: left;">2018-07-18</td>
<td style="text-align: right;">334039.80</td>
<td style="text-align: right;">2283912393</td>
<td style="text-align: left;">MULTIPOLYGON (((369644.2 47</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Chautauqua</td>
<td style="text-align: left;">CHAU</td>
<td style="text-align: left;">974105</td>
<td style="text-align: left;">36013</td>
<td style="text-align: left;">060000</td>
<td style="text-align: left;">West</td>
<td style="text-align: right;">141895</td>
<td style="text-align: right;">139750</td>
<td style="text-align: right;">134905</td>
<td style="text-align: right;">127657</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">1507.79455</td>
<td style="text-align: left;">2019-04-26</td>
<td style="text-align: right;">247508.47</td>
<td style="text-align: right;">3905169964</td>
<td style="text-align: left;">MULTIPOLYGON (((161319.8 47</td>
</tr>
<tr class="even">
<td style="text-align: left;">Chemung</td>
<td style="text-align: left;">CHEM</td>
<td style="text-align: left;">974106</td>
<td style="text-align: left;">36015</td>
<td style="text-align: left;">070000</td>
<td style="text-align: left;">Central</td>
<td style="text-align: right;">95195</td>
<td style="text-align: right;">91070</td>
<td style="text-align: right;">88830</td>
<td style="text-align: right;">84148</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">410.95932</td>
<td style="text-align: left;">2019-04-26</td>
<td style="text-align: right;">146916.78</td>
<td style="text-align: right;">1064379743</td>
<td style="text-align: left;">MULTIPOLYGON (((353386.9 46</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Chenango</td>
<td style="text-align: left;">CHEN</td>
<td style="text-align: left;">974107</td>
<td style="text-align: left;">36017</td>
<td style="text-align: left;">080000</td>
<td style="text-align: left;">Central</td>
<td style="text-align: right;">51768</td>
<td style="text-align: right;">51401</td>
<td style="text-align: right;">50477</td>
<td style="text-align: right;">47220</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">897.81864</td>
<td style="text-align: left;">2018-10-03</td>
<td style="text-align: right;">226955.16</td>
<td style="text-align: right;">2325339613</td>
<td style="text-align: left;">MULTIPOLYGON (((464936.4 47</td>
</tr>
<tr class="even">
<td style="text-align: left;">Clinton</td>
<td style="text-align: left;">CLIN</td>
<td style="text-align: left;">974108</td>
<td style="text-align: left;">36019</td>
<td style="text-align: left;">090000</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">85969</td>
<td style="text-align: right;">79894</td>
<td style="text-align: right;">82128</td>
<td style="text-align: right;">79843</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">1116.81373</td>
<td style="text-align: left;">2018-12-07</td>
<td style="text-align: right;">235243.35</td>
<td style="text-align: right;">2892534278</td>
<td style="text-align: left;">MULTIPOLYGON (((629506.7 49</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Columbia</td>
<td style="text-align: left;">COLU</td>
<td style="text-align: left;">974109</td>
<td style="text-align: left;">36021</td>
<td style="text-align: left;">100000</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">62982</td>
<td style="text-align: right;">63094</td>
<td style="text-align: right;">63096</td>
<td style="text-align: right;">61570</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">647.90750</td>
<td style="text-align: left;">2018-01-22</td>
<td style="text-align: right;">184324.65</td>
<td style="text-align: right;">1678072717</td>
<td style="text-align: left;">MULTIPOLYGON (((633818.3 47</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cortland</td>
<td style="text-align: left;">CORT</td>
<td style="text-align: left;">974110</td>
<td style="text-align: left;">36023</td>
<td style="text-align: left;">110000</td>
<td style="text-align: left;">Central</td>
<td style="text-align: right;">48963</td>
<td style="text-align: right;">48599</td>
<td style="text-align: right;">49336</td>
<td style="text-align: right;">46809</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">501.13939</td>
<td style="text-align: left;">2018-03-09</td>
<td style="text-align: right;">145854.77</td>
<td style="text-align: right;">1297945069</td>
<td style="text-align: left;">MULTIPOLYGON (((428566.6 46</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Delaware</td>
<td style="text-align: left;">DELA</td>
<td style="text-align: left;">974111</td>
<td style="text-align: left;">36025</td>
<td style="text-align: left;">120000</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">47225</td>
<td style="text-align: right;">48055</td>
<td style="text-align: right;">47980</td>
<td style="text-align: right;">44308</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">1466.34061</td>
<td style="text-align: left;">2020-05-19</td>
<td style="text-align: right;">283395.29</td>
<td style="text-align: right;">3797804752</td>
<td style="text-align: left;">MULTIPOLYGON (((522455.6 47</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dutchess</td>
<td style="text-align: left;">DUTC</td>
<td style="text-align: left;">974112</td>
<td style="text-align: left;">36027</td>
<td style="text-align: left;">130000</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">259462</td>
<td style="text-align: right;">280150</td>
<td style="text-align: right;">297488</td>
<td style="text-align: right;">295911</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">824.43935</td>
<td style="text-align: left;">2018-11-08</td>
<td style="text-align: right;">220942.56</td>
<td style="text-align: right;">2135288103</td>
<td style="text-align: left;">MULTIPOLYGON (((590247.8 46</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Erie</td>
<td style="text-align: left;">ERIE</td>
<td style="text-align: left;">974113</td>
<td style="text-align: left;">36029</td>
<td style="text-align: left;">140000</td>
<td style="text-align: left;">West</td>
<td style="text-align: right;">968532</td>
<td style="text-align: right;">950265</td>
<td style="text-align: right;">919040</td>
<td style="text-align: right;">954236</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">1221.97002</td>
<td style="text-align: left;">2017-10-30</td>
<td style="text-align: right;">327906.75</td>
<td style="text-align: right;">3164887818</td>
<td style="text-align: left;">MULTIPOLYGON (((204074.3 47</td>
</tr>
<tr class="even">
<td style="text-align: left;">Essex</td>
<td style="text-align: left;">ESSE</td>
<td style="text-align: left;">974114</td>
<td style="text-align: left;">36031</td>
<td style="text-align: left;">150000</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">37152</td>
<td style="text-align: right;">38851</td>
<td style="text-align: right;">39370</td>
<td style="text-align: right;">37381</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">1915.01996</td>
<td style="text-align: left;">2018-07-24</td>
<td style="text-align: right;">331906.61</td>
<td style="text-align: right;">4959878931</td>
<td style="text-align: left;">MULTIPOLYGON (((633423.4 49</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Franklin</td>
<td style="text-align: left;">FRAN</td>
<td style="text-align: left;">974115</td>
<td style="text-align: left;">36033</td>
<td style="text-align: left;">160000</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">46540</td>
<td style="text-align: right;">51134</td>
<td style="text-align: right;">51599</td>
<td style="text-align: right;">47555</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">1696.38234</td>
<td style="text-align: left;">2018-10-04</td>
<td style="text-align: right;">314349.88</td>
<td style="text-align: right;">4393610084</td>
<td style="text-align: left;">MULTIPOLYGON (((526445.3 49</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fulton</td>
<td style="text-align: left;">FULT</td>
<td style="text-align: left;">974116</td>
<td style="text-align: left;">36035</td>
<td style="text-align: left;">170000</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">54191</td>
<td style="text-align: right;">55073</td>
<td style="text-align: right;">55531</td>
<td style="text-align: right;">53324</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">532.62184</td>
<td style="text-align: left;">2018-11-01</td>
<td style="text-align: right;">176010.53</td>
<td style="text-align: right;">1379484243</td>
<td style="text-align: left;">MULTIPOLYGON (((530467.6 47</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Genesee</td>
<td style="text-align: left;">GENE</td>
<td style="text-align: left;">974117</td>
<td style="text-align: left;">36037</td>
<td style="text-align: left;">180000</td>
<td style="text-align: left;">West</td>
<td style="text-align: right;">60060</td>
<td style="text-align: right;">60370</td>
<td style="text-align: right;">60079</td>
<td style="text-align: right;">58388</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">496.05705</td>
<td style="text-align: left;">2018-02-12</td>
<td style="text-align: right;">155397.08</td>
<td style="text-align: right;">1284781856</td>
<td style="text-align: left;">MULTIPOLYGON (((223125.6 47</td>
</tr>
<tr class="even">
<td style="text-align: left;">Greene</td>
<td style="text-align: left;">GREE</td>
<td style="text-align: left;">974118</td>
<td style="text-align: left;">36039</td>
<td style="text-align: left;">190000</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">44739</td>
<td style="text-align: right;">48195</td>
<td style="text-align: right;">49221</td>
<td style="text-align: right;">47931</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">657.72008</td>
<td style="text-align: left;">2020-05-19</td>
<td style="text-align: right;">188783.30</td>
<td style="text-align: right;">1703487184</td>
<td style="text-align: left;">MULTIPOLYGON (((600650.4 47</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hamilton</td>
<td style="text-align: left;">HAMI</td>
<td style="text-align: left;">974119</td>
<td style="text-align: left;">36041</td>
<td style="text-align: left;">200000</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">5279</td>
<td style="text-align: right;">5379</td>
<td style="text-align: right;">4836</td>
<td style="text-align: right;">5107</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">1806.21213</td>
<td style="text-align: left;">2018-11-01</td>
<td style="text-align: right;">327370.62</td>
<td style="text-align: right;">4678067941</td>
<td style="text-align: left;">MULTIPOLYGON (((563263.6 48</td>
</tr>
<tr class="even">
<td style="text-align: left;">Herkimer</td>
<td style="text-align: left;">HERK</td>
<td style="text-align: left;">974120</td>
<td style="text-align: left;">36043</td>
<td style="text-align: left;">210000</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">65797</td>
<td style="text-align: right;">64427</td>
<td style="text-align: right;">64519</td>
<td style="text-align: right;">60139</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">1456.42011</td>
<td style="text-align: left;">2018-02-01</td>
<td style="text-align: right;">390792.54</td>
<td style="text-align: right;">3772110776</td>
<td style="text-align: left;">MULTIPOLYGON (((486349.2 48</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Jefferson</td>
<td style="text-align: left;">JEFF</td>
<td style="text-align: left;">974121</td>
<td style="text-align: left;">36045</td>
<td style="text-align: left;">220000</td>
<td style="text-align: left;">Central</td>
<td style="text-align: right;">110943</td>
<td style="text-align: right;">111738</td>
<td style="text-align: right;">116229</td>
<td style="text-align: right;">116721</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">1753.08298</td>
<td style="text-align: left;">2018-11-06</td>
<td style="text-align: right;">307750.57</td>
<td style="text-align: right;">4540464065</td>
<td style="text-align: left;">MULTIPOLYGON (((436294.5 49</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kings</td>
<td style="text-align: left;">KING</td>
<td style="text-align: left;">974122</td>
<td style="text-align: left;">36047</td>
<td style="text-align: left;">610000</td>
<td style="text-align: left;">Long Island</td>
<td style="text-align: right;">2300664</td>
<td style="text-align: right;">2465326</td>
<td style="text-align: right;">2504700</td>
<td style="text-align: right;">2736074</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Y</td>
<td style="text-align: right;">97.14561</td>
<td style="text-align: left;">2019-10-04</td>
<td style="text-align: right;">72427.92</td>
<td style="text-align: right;">251605964</td>
<td style="text-align: left;">MULTIPOLYGON (((590578.7 45</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lewis</td>
<td style="text-align: left;">LEWI</td>
<td style="text-align: left;">974123</td>
<td style="text-align: left;">36049</td>
<td style="text-align: left;">230000</td>
<td style="text-align: left;">Central</td>
<td style="text-align: right;">26796</td>
<td style="text-align: right;">26944</td>
<td style="text-align: right;">27087</td>
<td style="text-align: right;">26582</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">1289.73373</td>
<td style="text-align: left;">2018-11-06</td>
<td style="text-align: right;">255841.63</td>
<td style="text-align: right;">3340395038</td>
<td style="text-align: left;">MULTIPOLYGON (((486119 4882</td>
</tr>
<tr class="even">
<td style="text-align: left;">Livingston</td>
<td style="text-align: left;">LIVI</td>
<td style="text-align: left;">974124</td>
<td style="text-align: left;">36051</td>
<td style="text-align: left;">240000</td>
<td style="text-align: left;">West</td>
<td style="text-align: right;">62372</td>
<td style="text-align: right;">64328</td>
<td style="text-align: right;">65393</td>
<td style="text-align: right;">61834</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">640.50155</td>
<td style="text-align: left;">2018-09-20</td>
<td style="text-align: right;">237375.89</td>
<td style="text-align: right;">1658891412</td>
<td style="text-align: left;">MULTIPOLYGON (((277810.4 47</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Madison</td>
<td style="text-align: left;">MADI</td>
<td style="text-align: left;">974125</td>
<td style="text-align: left;">36053</td>
<td style="text-align: left;">250000</td>
<td style="text-align: left;">Central</td>
<td style="text-align: right;">69120</td>
<td style="text-align: right;">69441</td>
<td style="text-align: right;">73442</td>
<td style="text-align: right;">68016</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">660.76752</td>
<td style="text-align: left;">2018-07-18</td>
<td style="text-align: right;">256920.38</td>
<td style="text-align: right;">1711380019</td>
<td style="text-align: left;">MULTIPOLYGON (((419469.3 47</td>
</tr>
<tr class="even">
<td style="text-align: left;">Monroe</td>
<td style="text-align: left;">MONR</td>
<td style="text-align: left;">974126</td>
<td style="text-align: left;">36055</td>
<td style="text-align: left;">260000</td>
<td style="text-align: left;">West</td>
<td style="text-align: right;">713968</td>
<td style="text-align: right;">735343</td>
<td style="text-align: right;">744344</td>
<td style="text-align: right;">759443</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">1382.59447</td>
<td style="text-align: left;">2017-12-22</td>
<td style="text-align: right;">268311.09</td>
<td style="text-align: right;">3580903230</td>
<td style="text-align: left;">MULTIPOLYGON (((306943.2 47</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Montgomery</td>
<td style="text-align: left;">MONT</td>
<td style="text-align: left;">974127</td>
<td style="text-align: left;">36057</td>
<td style="text-align: left;">270000</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">51981</td>
<td style="text-align: right;">49708</td>
<td style="text-align: right;">50219</td>
<td style="text-align: right;">49532</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">409.99046</td>
<td style="text-align: left;">2018-02-01</td>
<td style="text-align: right;">148787.58</td>
<td style="text-align: right;">1061870418</td>
<td style="text-align: left;">MULTIPOLYGON (((534700.7 47</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nassau</td>
<td style="text-align: left;">NASS</td>
<td style="text-align: left;">974128</td>
<td style="text-align: left;">36059</td>
<td style="text-align: left;">280000</td>
<td style="text-align: left;">Long Island</td>
<td style="text-align: right;">1287348</td>
<td style="text-align: right;">1334544</td>
<td style="text-align: right;">1339532</td>
<td style="text-align: right;">1395774</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">446.63747</td>
<td style="text-align: left;">2018-04-12</td>
<td style="text-align: right;">168031.84</td>
<td style="text-align: right;">1156785733</td>
<td style="text-align: left;">MULTIPOLYGON (((632171.2 45</td>
</tr>
<tr class="odd">
<td style="text-align: left;">New York</td>
<td style="text-align: left;">NEWY</td>
<td style="text-align: left;">974129</td>
<td style="text-align: left;">36061</td>
<td style="text-align: left;">620000</td>
<td style="text-align: left;">Long Island</td>
<td style="text-align: right;">1487536</td>
<td style="text-align: right;">1537195</td>
<td style="text-align: right;">1585873</td>
<td style="text-align: right;">1694251</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Y</td>
<td style="text-align: right;">33.72563</td>
<td style="text-align: left;">2019-10-04</td>
<td style="text-align: right;">60023.61</td>
<td style="text-align: right;">87348991</td>
<td style="text-align: left;">MULTIPOLYGON (((580767.7 45</td>
</tr>
<tr class="even">
<td style="text-align: left;">Niagara</td>
<td style="text-align: left;">NIAG</td>
<td style="text-align: left;">974130</td>
<td style="text-align: left;">36063</td>
<td style="text-align: left;">290000</td>
<td style="text-align: left;">West</td>
<td style="text-align: right;">220756</td>
<td style="text-align: right;">219846</td>
<td style="text-align: right;">216469</td>
<td style="text-align: right;">212666</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">1140.64668</td>
<td style="text-align: left;">2018-03-26</td>
<td style="text-align: right;">261349.59</td>
<td style="text-align: right;">2954261351</td>
<td style="text-align: left;">MULTIPOLYGON (((218080.7 47</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Oneida</td>
<td style="text-align: left;">ONEI</td>
<td style="text-align: left;">974131</td>
<td style="text-align: left;">36065</td>
<td style="text-align: left;">300000</td>
<td style="text-align: left;">Central</td>
<td style="text-align: right;">250836</td>
<td style="text-align: right;">235469</td>
<td style="text-align: right;">234878</td>
<td style="text-align: right;">232125</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">1257.21214</td>
<td style="text-align: left;">2018-03-09</td>
<td style="text-align: right;">307349.03</td>
<td style="text-align: right;">3256164502</td>
<td style="text-align: left;">MULTIPOLYGON (((492898 4808</td>
</tr>
<tr class="even">
<td style="text-align: left;">Onondaga</td>
<td style="text-align: left;">ONON</td>
<td style="text-align: left;">974132</td>
<td style="text-align: left;">36067</td>
<td style="text-align: left;">310000</td>
<td style="text-align: left;">Central</td>
<td style="text-align: right;">468973</td>
<td style="text-align: right;">458336</td>
<td style="text-align: right;">467026</td>
<td style="text-align: right;">476516</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">805.02218</td>
<td style="text-align: left;">2018-07-18</td>
<td style="text-align: right;">235290.72</td>
<td style="text-align: right;">2084997862</td>
<td style="text-align: left;">MULTIPOLYGON (((405851 4788</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ontario</td>
<td style="text-align: left;">ONTA</td>
<td style="text-align: left;">974133</td>
<td style="text-align: left;">36069</td>
<td style="text-align: left;">320000</td>
<td style="text-align: left;">Central</td>
<td style="text-align: right;">95101</td>
<td style="text-align: right;">100224</td>
<td style="text-align: right;">107931</td>
<td style="text-align: right;">112458</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">662.47890</td>
<td style="text-align: left;">2018-02-08</td>
<td style="text-align: right;">216680.25</td>
<td style="text-align: right;">1715812473</td>
<td style="text-align: left;">MULTIPOLYGON (((319443.6 47</td>
</tr>
<tr class="even">
<td style="text-align: left;">Orange</td>
<td style="text-align: left;">ORAN</td>
<td style="text-align: left;">974134</td>
<td style="text-align: left;">36071</td>
<td style="text-align: left;">330000</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">307647</td>
<td style="text-align: right;">341367</td>
<td style="text-align: right;">372813</td>
<td style="text-align: right;">401310</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">837.15060</td>
<td style="text-align: left;">2020-05-15</td>
<td style="text-align: right;">224866.68</td>
<td style="text-align: right;">2168210100</td>
<td style="text-align: left;">MULTIPOLYGON (((561216.3 46</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Orleans</td>
<td style="text-align: left;">ORLE</td>
<td style="text-align: left;">974135</td>
<td style="text-align: left;">36073</td>
<td style="text-align: left;">340000</td>
<td style="text-align: left;">West</td>
<td style="text-align: right;">41846</td>
<td style="text-align: right;">44171</td>
<td style="text-align: right;">42883</td>
<td style="text-align: right;">40343</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">812.16899</td>
<td style="text-align: left;">2018-02-12</td>
<td style="text-align: right;">186740.28</td>
<td style="text-align: right;">2103508020</td>
<td style="text-align: left;">MULTIPOLYGON (((256280.7 47</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oswego</td>
<td style="text-align: left;">OSWE</td>
<td style="text-align: left;">974136</td>
<td style="text-align: left;">36075</td>
<td style="text-align: left;">350000</td>
<td style="text-align: left;">Central</td>
<td style="text-align: right;">121771</td>
<td style="text-align: right;">122377</td>
<td style="text-align: right;">122109</td>
<td style="text-align: right;">117525</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">1400.45244</td>
<td style="text-align: left;">2018-03-26</td>
<td style="text-align: right;">307605.70</td>
<td style="text-align: right;">3627155171</td>
<td style="text-align: left;">MULTIPOLYGON (((409549.2 48</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Otsego</td>
<td style="text-align: left;">OTSE</td>
<td style="text-align: left;">974137</td>
<td style="text-align: left;">36077</td>
<td style="text-align: left;">360000</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">60517</td>
<td style="text-align: right;">61676</td>
<td style="text-align: right;">62259</td>
<td style="text-align: right;">58524</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">1014.86328</td>
<td style="text-align: left;">2020-05-19</td>
<td style="text-align: right;">280625.62</td>
<td style="text-align: right;">2628483836</td>
<td style="text-align: left;">MULTIPOLYGON (((501372.3 47</td>
</tr>
<tr class="even">
<td style="text-align: left;">Putnam</td>
<td style="text-align: left;">PUTN</td>
<td style="text-align: left;">974138</td>
<td style="text-align: left;">36079</td>
<td style="text-align: left;">370000</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">83941</td>
<td style="text-align: right;">95745</td>
<td style="text-align: right;">99710</td>
<td style="text-align: right;">97668</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">245.98902</td>
<td style="text-align: left;">2018-11-08</td>
<td style="text-align: right;">110496.84</td>
<td style="text-align: right;">637108648</td>
<td style="text-align: left;">MULTIPOLYGON (((620790.8 45</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Queens</td>
<td style="text-align: left;">QUEE</td>
<td style="text-align: left;">974139</td>
<td style="text-align: left;">36081</td>
<td style="text-align: left;">630000</td>
<td style="text-align: left;">Long Island</td>
<td style="text-align: right;">1951598</td>
<td style="text-align: right;">2229379</td>
<td style="text-align: right;">2230722</td>
<td style="text-align: right;">2405464</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Y</td>
<td style="text-align: right;">179.51251</td>
<td style="text-align: left;">2019-10-04</td>
<td style="text-align: right;">141111.45</td>
<td style="text-align: right;">464935273</td>
<td style="text-align: left;">MULTIPOLYGON (((603175.3 45</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rensselaer</td>
<td style="text-align: left;">RENS</td>
<td style="text-align: left;">974140</td>
<td style="text-align: left;">36083</td>
<td style="text-align: left;">380000</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">154429</td>
<td style="text-align: right;">152538</td>
<td style="text-align: right;">159429</td>
<td style="text-align: right;">161130</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">665.08835</td>
<td style="text-align: left;">2017-11-10</td>
<td style="text-align: right;">177749.49</td>
<td style="text-align: right;">1722570914</td>
<td style="text-align: left;">MULTIPOLYGON (((628303.4 47</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Richmond</td>
<td style="text-align: left;">RICH</td>
<td style="text-align: left;">974141</td>
<td style="text-align: left;">36085</td>
<td style="text-align: left;">640000</td>
<td style="text-align: left;">Long Island</td>
<td style="text-align: right;">378977</td>
<td style="text-align: right;">443728</td>
<td style="text-align: right;">468730</td>
<td style="text-align: right;">495747</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Y</td>
<td style="text-align: right;">102.46085</td>
<td style="text-align: left;">2019-10-04</td>
<td style="text-align: right;">67419.78</td>
<td style="text-align: right;">265372393</td>
<td style="text-align: left;">MULTIPOLYGON (((579822 4500</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rockland</td>
<td style="text-align: left;">ROCK</td>
<td style="text-align: left;">974142</td>
<td style="text-align: left;">36087</td>
<td style="text-align: left;">390000</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">265475</td>
<td style="text-align: right;">286753</td>
<td style="text-align: right;">311687</td>
<td style="text-align: right;">338329</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">199.34184</td>
<td style="text-align: left;">2019-10-04</td>
<td style="text-align: right;">103259.43</td>
<td style="text-align: right;">516292998</td>
<td style="text-align: left;">MULTIPOLYGON (((593050.6 45</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Saratoga</td>
<td style="text-align: left;">SARA</td>
<td style="text-align: left;">974143</td>
<td style="text-align: left;">36091</td>
<td style="text-align: left;">410000</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">181276</td>
<td style="text-align: right;">200635</td>
<td style="text-align: right;">219607</td>
<td style="text-align: right;">235509</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">843.59404</td>
<td style="text-align: left;">2017-11-10</td>
<td style="text-align: right;">244735.85</td>
<td style="text-align: right;">2184898537</td>
<td style="text-align: left;">MULTIPOLYGON (((594734.2 47</td>
</tr>
<tr class="even">
<td style="text-align: left;">Schenectady</td>
<td style="text-align: left;">SCHE</td>
<td style="text-align: left;">974144</td>
<td style="text-align: left;">36093</td>
<td style="text-align: left;">420000</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">149285</td>
<td style="text-align: right;">146555</td>
<td style="text-align: right;">154727</td>
<td style="text-align: right;">158061</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">209.55386</td>
<td style="text-align: left;">2018-11-08</td>
<td style="text-align: right;">118236.71</td>
<td style="text-align: right;">542742009</td>
<td style="text-align: left;">MULTIPOLYGON (((585241.4 47</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Schoharie</td>
<td style="text-align: left;">SCHO</td>
<td style="text-align: left;">974145</td>
<td style="text-align: left;">36095</td>
<td style="text-align: left;">430000</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">31859</td>
<td style="text-align: right;">31582</td>
<td style="text-align: right;">32749</td>
<td style="text-align: right;">29714</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">625.83860</td>
<td style="text-align: left;">2020-05-19</td>
<td style="text-align: right;">186763.71</td>
<td style="text-align: right;">1620914521</td>
<td style="text-align: left;">MULTIPOLYGON (((544585.1 47</td>
</tr>
<tr class="even">
<td style="text-align: left;">Schuyler</td>
<td style="text-align: left;">SCHU</td>
<td style="text-align: left;">974146</td>
<td style="text-align: left;">36097</td>
<td style="text-align: left;">440000</td>
<td style="text-align: left;">Central</td>
<td style="text-align: right;">18662</td>
<td style="text-align: right;">19224</td>
<td style="text-align: right;">18343</td>
<td style="text-align: right;">17898</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">342.12875</td>
<td style="text-align: left;">2018-11-13</td>
<td style="text-align: right;">157807.45</td>
<td style="text-align: right;">886109393</td>
<td style="text-align: left;">MULTIPOLYGON (((360703.8 47</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Seneca</td>
<td style="text-align: left;">SENE</td>
<td style="text-align: left;">974147</td>
<td style="text-align: left;">36099</td>
<td style="text-align: left;">450000</td>
<td style="text-align: left;">Central</td>
<td style="text-align: right;">33683</td>
<td style="text-align: right;">33342</td>
<td style="text-align: right;">35251</td>
<td style="text-align: right;">33814</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">390.35722</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">162301.31</td>
<td style="text-align: right;">1011020552</td>
<td style="text-align: left;">MULTIPOLYGON (((360411.1 47</td>
</tr>
<tr class="even">
<td style="text-align: left;">St Lawrence</td>
<td style="text-align: left;">STLA</td>
<td style="text-align: left;">977309</td>
<td style="text-align: left;">36089</td>
<td style="text-align: left;">400000</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">111974</td>
<td style="text-align: right;">111931</td>
<td style="text-align: right;">111944</td>
<td style="text-align: right;">108505</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">2818.74261</td>
<td style="text-align: left;">2018-11-19</td>
<td style="text-align: right;">349497.58</td>
<td style="text-align: right;">7300509854</td>
<td style="text-align: left;">MULTIPOLYGON (((513668 4984</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Steuben</td>
<td style="text-align: left;">STEU</td>
<td style="text-align: left;">974148</td>
<td style="text-align: left;">36101</td>
<td style="text-align: left;">460000</td>
<td style="text-align: left;">Central</td>
<td style="text-align: right;">99088</td>
<td style="text-align: right;">98726</td>
<td style="text-align: right;">98990</td>
<td style="text-align: right;">93584</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">1404.07792</td>
<td style="text-align: left;">2019-04-26</td>
<td style="text-align: right;">259450.27</td>
<td style="text-align: right;">3636545126</td>
<td style="text-align: left;">MULTIPOLYGON (((283514.2 47</td>
</tr>
<tr class="even">
<td style="text-align: left;">Suffolk</td>
<td style="text-align: left;">SUFF</td>
<td style="text-align: left;">974149</td>
<td style="text-align: left;">36103</td>
<td style="text-align: left;">470000</td>
<td style="text-align: left;">Long Island</td>
<td style="text-align: right;">1321864</td>
<td style="text-align: right;">1419369</td>
<td style="text-align: right;">1493350</td>
<td style="text-align: right;">1525920</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">2372.63419</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">385044.84</td>
<td style="text-align: right;">6145094330</td>
<td style="text-align: left;">MULTIPOLYGON (((741116.9 45</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sullivan</td>
<td style="text-align: left;">SULL</td>
<td style="text-align: left;">974150</td>
<td style="text-align: left;">36105</td>
<td style="text-align: left;">480000</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">69277</td>
<td style="text-align: right;">73966</td>
<td style="text-align: right;">77547</td>
<td style="text-align: right;">78624</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">995.45497</td>
<td style="text-align: left;">2020-05-15</td>
<td style="text-align: right;">255870.76</td>
<td style="text-align: right;">2578216525</td>
<td style="text-align: left;">MULTIPOLYGON (((543999.4 46</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tioga</td>
<td style="text-align: left;">TIOG</td>
<td style="text-align: left;">974151</td>
<td style="text-align: left;">36107</td>
<td style="text-align: left;">490000</td>
<td style="text-align: left;">Central</td>
<td style="text-align: right;">52337</td>
<td style="text-align: right;">51784</td>
<td style="text-align: right;">51125</td>
<td style="text-align: right;">48455</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">522.40112</td>
<td style="text-align: left;">2019-04-26</td>
<td style="text-align: right;">195615.73</td>
<td style="text-align: right;">1353012695</td>
<td style="text-align: left;">MULTIPOLYGON (((407005.2 46</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tompkins</td>
<td style="text-align: left;">TOMP</td>
<td style="text-align: left;">974152</td>
<td style="text-align: left;">36109</td>
<td style="text-align: left;">500000</td>
<td style="text-align: left;">Central</td>
<td style="text-align: right;">94097</td>
<td style="text-align: right;">96501</td>
<td style="text-align: right;">101564</td>
<td style="text-align: right;">105740</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">491.56956</td>
<td style="text-align: left;">2018-11-28</td>
<td style="text-align: right;">175483.42</td>
<td style="text-align: right;">1273159304</td>
<td style="text-align: left;">MULTIPOLYGON (((380383 4720</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ulster</td>
<td style="text-align: left;">ULST</td>
<td style="text-align: left;">974153</td>
<td style="text-align: left;">36111</td>
<td style="text-align: left;">510000</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">165304</td>
<td style="text-align: right;">177749</td>
<td style="text-align: right;">182493</td>
<td style="text-align: right;">181851</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">1161.25472</td>
<td style="text-align: left;">2017-10-25</td>
<td style="text-align: right;">275405.52</td>
<td style="text-align: right;">3007635918</td>
<td style="text-align: left;">MULTIPOLYGON (((583570 4669</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Warren</td>
<td style="text-align: left;">WARR</td>
<td style="text-align: left;">974154</td>
<td style="text-align: left;">36113</td>
<td style="text-align: left;">520000</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">59209</td>
<td style="text-align: right;">63303</td>
<td style="text-align: right;">65707</td>
<td style="text-align: right;">65737</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">930.66894</td>
<td style="text-align: left;">2018-12-03</td>
<td style="text-align: right;">264775.52</td>
<td style="text-align: right;">2410421491</td>
<td style="text-align: left;">MULTIPOLYGON (((625724 4850</td>
</tr>
<tr class="even">
<td style="text-align: left;">Washington</td>
<td style="text-align: left;">WASH</td>
<td style="text-align: left;">974155</td>
<td style="text-align: left;">36115</td>
<td style="text-align: left;">530000</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">59330</td>
<td style="text-align: right;">61042</td>
<td style="text-align: right;">63216</td>
<td style="text-align: right;">61302</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">845.85571</td>
<td style="text-align: left;">2017-11-10</td>
<td style="text-align: right;">302359.00</td>
<td style="text-align: right;">2190756227</td>
<td style="text-align: left;">MULTIPOLYGON (((630545.5 48</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Wayne</td>
<td style="text-align: left;">WAYN</td>
<td style="text-align: left;">974156</td>
<td style="text-align: left;">36117</td>
<td style="text-align: left;">540000</td>
<td style="text-align: left;">Central</td>
<td style="text-align: right;">89123</td>
<td style="text-align: right;">93765</td>
<td style="text-align: right;">93772</td>
<td style="text-align: right;">91283</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">1395.59896</td>
<td style="text-align: left;">2018-02-08</td>
<td style="text-align: right;">254972.22</td>
<td style="text-align: right;">3614584709</td>
<td style="text-align: left;">MULTIPOLYGON (((359224.7 48</td>
</tr>
<tr class="even">
<td style="text-align: left;">Westchester</td>
<td style="text-align: left;">WEST</td>
<td style="text-align: left;">974157</td>
<td style="text-align: left;">36119</td>
<td style="text-align: left;">550000</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">874866</td>
<td style="text-align: right;">923459</td>
<td style="text-align: right;">949113</td>
<td style="text-align: right;">1004457</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">499.97290</td>
<td style="text-align: left;">2019-10-04</td>
<td style="text-align: right;">182997.68</td>
<td style="text-align: right;">1294923860</td>
<td style="text-align: left;">MULTIPOLYGON (((621529.9 45</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Wyoming</td>
<td style="text-align: left;">WYOM</td>
<td style="text-align: left;">974158</td>
<td style="text-align: left;">36121</td>
<td style="text-align: left;">560000</td>
<td style="text-align: left;">West</td>
<td style="text-align: right;">42507</td>
<td style="text-align: right;">43424</td>
<td style="text-align: right;">42155</td>
<td style="text-align: right;">40531</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">596.82263</td>
<td style="text-align: left;">2018-09-20</td>
<td style="text-align: right;">176096.93</td>
<td style="text-align: right;">1545763522</td>
<td style="text-align: left;">MULTIPOLYGON (((225124.6 47</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yates</td>
<td style="text-align: left;">YATE</td>
<td style="text-align: left;">974159</td>
<td style="text-align: left;">36123</td>
<td style="text-align: left;">570000</td>
<td style="text-align: left;">Central</td>
<td style="text-align: right;">22810</td>
<td style="text-align: right;">24621</td>
<td style="text-align: right;">25348</td>
<td style="text-align: right;">24774</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">375.77154</td>
<td style="text-align: left;">2018-02-08</td>
<td style="text-align: right;">141535.64</td>
<td style="text-align: right;">973243818</td>
<td style="text-align: left;">MULTIPOLYGON (((317299.3 47</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="do">## neighbors</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spdep)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>lyme_nb <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(nys_lyme_data,<span class="at">queen =</span> <span class="cn">TRUE</span>)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(lyme_nb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "nb"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(lyme_nb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 61
 $ : int [1:6] 11 20 42 45 46 47
 $ : int [1:4] 5 26 50 60
 $ : int [1:4] 30 31 41 59
 $ : int [1:4] 9 12 13 53
 $ : int [1:4] 2 7 15 60
 $ : int [1:7] 12 23 34 38 49 54 58
 $ : int [1:2] 5 15
 $ : int [1:4] 48 50 53 54
 $ : int [1:5] 4 12 13 27 39
 $ : int [1:2] 16 17
 $ : int [1:5] 1 14 20 42 55
 $ : int [1:7] 4 6 9 27 34 53 54
 $ : int [1:7] 4 9 20 39 47 52 55
 $ : int [1:4] 11 36 40 55
 $ : int [1:5] 5 7 19 32 60
 $ : int [1:5] 10 17 21 56 57
 $ : int [1:3] 10 16 21
 $ : int [1:4] 21 22 29 45
 $ : int [1:6] 15 26 28 32 37 60
 $ : int [1:6] 1 11 13 42 47 55
 $ : int [1:6] 16 17 18 22 45 56
 $ : int [1:6] 18 21 25 29 33 39
 $ : int [1:3] 6 25 38
 $ : int [1:3] 31 41 43
 $ : int [1:4] 22 23 33 38
 $ : int [1:6] 2 19 28 35 50 60
 $ : int [1:6] 9 12 33 34 38 39
 $ : int [1:5] 19 26 35 37 58
 $ : int [1:6] 18 22 39 45 46 47
 $ : int [1:4] 3 41 51 59
 $ : int [1:3] 3 24 41
 $ : int [1:3] 15 19 37
 $ : int [1:5] 22 25 27 38 39
 $ : int [1:4] 6 12 27 38
 $ : int [1:6] 26 28 49 50 58 61
 $ : int [1:5] 14 40 44 52 55
 $ : int [1:3] 19 28 32
 $ : int [1:6] 6 23 25 27 33 34
 $ : int [1:7] 9 13 22 27 29 33 47
 $ : int [1:4] 14 36 44 59
 $ : int [1:5] 3 24 30 31 43
 $ : int [1:5] 1 11 20 45 57
 $ : int [1:2] 24 41
 $ : int [1:3] 36 40 59
 $ : int [1:8] 1 18 21 29 42 46 56 57
 $ : int [1:4] 1 29 45 47
 $ : int [1:6] 1 13 20 29 39 46
 $ : int [1:5] 8 49 50 54 61
 $ : int [1:6] 6 35 48 54 58 61
 $ : int [1:6] 2 8 26 35 48 61
 $ : int 30
 $ : int [1:3] 13 36 55
 $ : int [1:4] 4 8 12 54
 $ : int [1:6] 6 8 12 48 49 53
 $ : int [1:6] 11 13 14 20 36 52
 $ : int [1:4] 16 21 45 57
 $ : int [1:4] 16 42 45 56
 $ : int [1:4] 6 28 35 49
 $ : int [1:4] 3 30 40 44
 $ : int [1:5] 2 5 15 19 26
 $ : int [1:4] 35 48 49 50
 - attr(*, "class")= chr "nb"
 - attr(*, "region.id")= chr [1:61] "1" "2" "3" "4" ...
 - attr(*, "call")= language poly2nb(pl = nys_lyme_data, queen = TRUE)
 - attr(*, "type")= chr "queen"
 - attr(*, "snap")= num 0.01
 - attr(*, "sym")= logi TRUE
 - attr(*, "ncomp")=List of 2
  ..$ nc     : num 1
  ..$ comp.id: num [1:61] 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_geometry</span>(nys_lyme_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Geometry set for 61 features 
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 105571.4 ymin: 4480943 xmax: 779932.1 ymax: 4985476
Projected CRS: NAD83 / UTM zone 18N
First 5 geometries:</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># st_crs(sf1)</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="co"># st_crs(sf2)</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co"># # Reproject if needed</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="co"># sf2 &lt;- st_transform(sf2, crs = st_crs(sf1))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(nys_lyme_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: NAD83 / UTM zone 18N 
  wkt:
PROJCRS["NAD83 / UTM zone 18N",
    BASEGEOGCRS["NAD83",
        DATUM["North American Datum 1983",
            ELLIPSOID["GRS 1980",6378137,298.257222101,
                LENGTHUNIT["metre",1]]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4269]],
    CONVERSION["UTM zone 18N",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",0,
            ANGLEUNIT["Degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",-75,
            ANGLEUNIT["Degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",0.9996,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",500000,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",0,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["(E)",east,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["(N)",north,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    ID["EPSG",26918]]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(nyc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: NAD83 / UTM zone 18N 
  wkt:
PROJCRS["NAD83 / UTM zone 18N",
    BASEGEOGCRS["NAD83",
        DATUM["North American Datum 1983",
            ELLIPSOID["GRS 1980",6378137,298.257222101,
                LENGTHUNIT["metre",1]]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4269]],
    CONVERSION["UTM zone 18N",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",0,
            ANGLEUNIT["Degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",-75,
            ANGLEUNIT["Degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",0.9996,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",500000,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",0,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["(E)",east,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["(N)",north,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    ID["EPSG",26918]]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="do">## to join two sf objects with dplyr, you must drop the geometry of one of the dataframes</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>lyme_attr <span class="ot">&lt;-</span> <span class="fu">st_drop_geometry</span>(lyme_data)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>nys_lyme_joined <span class="ot">&lt;-</span> <span class="fu">left_join</span>(nyc,lyme_attr,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"NAME"</span>,<span class="st">"FIPS_CODE"</span>))</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>nys_lyme_joined <span class="ot">&lt;-</span>  nys_lyme_joined <span class="sc">|&gt;</span>  </span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Lyme.Incidence.Rate))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spdep)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="do">## contiguity based </span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>lyme_nb <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(nys_lyme_joined,<span class="at">queen =</span> <span class="cn">TRUE</span>)</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>lyme_weights <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(lyme_nb,<span class="at">style =</span> <span class="st">"W"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(lyme_nb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 61
 $ : int [1:6] 11 20 42 45 46 47
 $ : int [1:4] 5 26 50 60
 $ : int [1:4] 30 31 41 59
 $ : int [1:4] 9 12 13 53
 $ : int [1:4] 2 7 15 60
 $ : int [1:7] 12 23 34 38 49 54 58
 $ : int [1:2] 5 15
 $ : int [1:4] 48 50 53 54
 $ : int [1:5] 4 12 13 27 39
 $ : int [1:2] 16 17
 $ : int [1:5] 1 14 20 42 55
 $ : int [1:7] 4 6 9 27 34 53 54
 $ : int [1:7] 4 9 20 39 47 52 55
 $ : int [1:4] 11 36 40 55
 $ : int [1:5] 5 7 19 32 60
 $ : int [1:5] 10 17 21 56 57
 $ : int [1:3] 10 16 21
 $ : int [1:4] 21 22 29 45
 $ : int [1:6] 15 26 28 32 37 60
 $ : int [1:6] 1 11 13 42 47 55
 $ : int [1:6] 16 17 18 22 45 56
 $ : int [1:6] 18 21 25 29 33 39
 $ : int [1:3] 6 25 38
 $ : int [1:3] 31 41 43
 $ : int [1:4] 22 23 33 38
 $ : int [1:6] 2 19 28 35 50 60
 $ : int [1:6] 9 12 33 34 38 39
 $ : int [1:5] 19 26 35 37 58
 $ : int [1:6] 18 22 39 45 46 47
 $ : int [1:4] 3 41 51 59
 $ : int [1:3] 3 24 41
 $ : int [1:3] 15 19 37
 $ : int [1:5] 22 25 27 38 39
 $ : int [1:4] 6 12 27 38
 $ : int [1:6] 26 28 49 50 58 61
 $ : int [1:5] 14 40 44 52 55
 $ : int [1:3] 19 28 32
 $ : int [1:6] 6 23 25 27 33 34
 $ : int [1:7] 9 13 22 27 29 33 47
 $ : int [1:4] 14 36 44 59
 $ : int [1:5] 3 24 30 31 43
 $ : int [1:5] 1 11 20 45 57
 $ : int [1:2] 24 41
 $ : int [1:3] 36 40 59
 $ : int [1:8] 1 18 21 29 42 46 56 57
 $ : int [1:4] 1 29 45 47
 $ : int [1:6] 1 13 20 29 39 46
 $ : int [1:5] 8 49 50 54 61
 $ : int [1:6] 6 35 48 54 58 61
 $ : int [1:6] 2 8 26 35 48 61
 $ : int 30
 $ : int [1:3] 13 36 55
 $ : int [1:4] 4 8 12 54
 $ : int [1:6] 6 8 12 48 49 53
 $ : int [1:6] 11 13 14 20 36 52
 $ : int [1:4] 16 21 45 57
 $ : int [1:4] 16 42 45 56
 $ : int [1:4] 6 28 35 49
 $ : int [1:4] 3 30 40 44
 $ : int [1:5] 2 5 15 19 26
 $ : int [1:4] 35 48 49 50
 - attr(*, "class")= chr "nb"
 - attr(*, "region.id")= chr [1:61] "1" "2" "3" "4" ...
 - attr(*, "call")= language poly2nb(pl = nys_lyme_joined, queen = TRUE)
 - attr(*, "type")= chr "queen"
 - attr(*, "snap")= num 0.01
 - attr(*, "sym")= logi TRUE
 - attr(*, "ncomp")=List of 2
  ..$ nc     : num 1
  ..$ comp.id: num [1:61] 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="do">## K-nearest neighbors</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(nys_lyme_joined))</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>lyme_knn_nb <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords,<span class="at">k =</span> <span class="dv">5</span>))</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(lyme_knn_nb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 61
 $ : int [1:5] 11 20 42 46 47
 $ : int [1:5] 5 15 26 50 60
 $ : int [1:5] 24 30 31 41 59
 $ : int [1:5] 9 12 13 53 54
 $ : int [1:5] 2 7 15 26 60
 $ : int [1:5] 34 38 49 58 61
 $ : int [1:5] 2 5 15 32 60
 $ : int [1:5] 48 50 53 54 61
 $ : int [1:5] 4 12 13 27 39
 $ : int [1:5] 16 17 21 56 57
 $ : int [1:5] 1 14 20 42 55
 $ : int [1:5] 9 27 34 53 54
 $ : int [1:5] 9 39 47 52 55
 $ : int [1:5] 11 20 36 40 55
 $ : int [1:5] 5 7 19 32 60
 $ : int [1:5] 10 17 21 56 57
 $ : int [1:5] 10 16 21 25 56
 $ : int [1:5] 22 29 45 46 47
 $ : int [1:5] 15 26 28 37 60
 $ : int [1:5] 1 11 46 47 55
 $ : int [1:5] 16 18 22 25 56
 $ : int [1:5] 18 21 25 29 33
 $ : int [1:5] 22 25 33 38 58
 $ : int [1:5] 3 30 31 41 43
 $ : int [1:5] 21 22 23 33 38
 $ : int [1:5] 2 19 35 60 61
 $ : int [1:5] 9 12 33 34 39
 $ : int [1:5] 19 26 35 37 58
 $ : int [1:5] 1 18 45 46 47
 $ : int [1:5] 3 24 31 41 59
 $ : int [1:5] 3 24 30 41 43
 $ : int [1:5] 15 19 28 37 60
 $ : int [1:5] 22 25 27 34 38
 $ : int [1:5] 6 12 27 38 49
 $ : int [1:5] 26 28 49 58 61
 $ : int [1:5] 40 44 52 55 59
 $ : int [1:5] 19 26 28 32 60
 $ : int [1:5] 6 23 33 34 58
 $ : int [1:5] 9 13 27 29 47
 $ : int [1:5] 3 14 36 44 59
 $ : int [1:5] 3 24 30 31 43
 $ : int [1:5] 1 11 45 46 57
 $ : int [1:5] 3 24 30 31 41
 $ : int [1:5] 3 31 36 40 59
 $ : int [1:5] 18 29 46 56 57
 $ : int [1:5] 1 18 29 45 47
 $ : int [1:5] 1 20 29 39 46
 $ : int [1:5] 8 49 50 54 61
 $ : int [1:5] 6 35 48 54 61
 $ : int [1:5] 2 8 26 48 61
 $ : int [1:5] 3 30 40 41 59
 $ : int [1:5] 13 14 20 36 55
 $ : int [1:5] 4 8 12 48 54
 $ : int [1:5] 8 12 48 49 53
 $ : int [1:5] 11 14 20 36 52
 $ : int [1:5] 16 18 21 45 57
 $ : int [1:5] 18 42 45 46 56
 $ : int [1:5] 6 28 35 38 49
 $ : int [1:5] 3 30 31 40 44
 $ : int [1:5] 2 5 15 19 26
 $ : int [1:5] 35 48 49 50 54
 - attr(*, "region.id")= chr [1:61] "1" "2" "3" "4" ...
 - attr(*, "call")= language knearneigh(x = coords, k = 5)
 - attr(*, "sym")= logi FALSE
 - attr(*, "type")= chr "knn"
 - attr(*, "knn-k")= num 5
 - attr(*, "class")= chr "nb"
 - attr(*, "ncomp")=List of 2
  ..$ nc     : num 1
  ..$ comp.id: num [1:61] 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>knn_weights <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(lyme_knn_nb,<span class="at">style =</span> <span class="st">"W"</span>)  <span class="co"># Row-standardized weights</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(knn_weights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 3
 $ style     : chr "W"
 $ neighbours:List of 61
  ..$ : int [1:5] 11 20 42 46 47
  ..$ : int [1:5] 5 15 26 50 60
  ..$ : int [1:5] 24 30 31 41 59
  ..$ : int [1:5] 9 12 13 53 54
  ..$ : int [1:5] 2 7 15 26 60
  ..$ : int [1:5] 34 38 49 58 61
  ..$ : int [1:5] 2 5 15 32 60
  ..$ : int [1:5] 48 50 53 54 61
  ..$ : int [1:5] 4 12 13 27 39
  ..$ : int [1:5] 16 17 21 56 57
  ..$ : int [1:5] 1 14 20 42 55
  ..$ : int [1:5] 9 27 34 53 54
  ..$ : int [1:5] 9 39 47 52 55
  ..$ : int [1:5] 11 20 36 40 55
  ..$ : int [1:5] 5 7 19 32 60
  ..$ : int [1:5] 10 17 21 56 57
  ..$ : int [1:5] 10 16 21 25 56
  ..$ : int [1:5] 22 29 45 46 47
  ..$ : int [1:5] 15 26 28 37 60
  ..$ : int [1:5] 1 11 46 47 55
  ..$ : int [1:5] 16 18 22 25 56
  ..$ : int [1:5] 18 21 25 29 33
  ..$ : int [1:5] 22 25 33 38 58
  ..$ : int [1:5] 3 30 31 41 43
  ..$ : int [1:5] 21 22 23 33 38
  ..$ : int [1:5] 2 19 35 60 61
  ..$ : int [1:5] 9 12 33 34 39
  ..$ : int [1:5] 19 26 35 37 58
  ..$ : int [1:5] 1 18 45 46 47
  ..$ : int [1:5] 3 24 31 41 59
  ..$ : int [1:5] 3 24 30 41 43
  ..$ : int [1:5] 15 19 28 37 60
  ..$ : int [1:5] 22 25 27 34 38
  ..$ : int [1:5] 6 12 27 38 49
  ..$ : int [1:5] 26 28 49 58 61
  ..$ : int [1:5] 40 44 52 55 59
  ..$ : int [1:5] 19 26 28 32 60
  ..$ : int [1:5] 6 23 33 34 58
  ..$ : int [1:5] 9 13 27 29 47
  ..$ : int [1:5] 3 14 36 44 59
  ..$ : int [1:5] 3 24 30 31 43
  ..$ : int [1:5] 1 11 45 46 57
  ..$ : int [1:5] 3 24 30 31 41
  ..$ : int [1:5] 3 31 36 40 59
  ..$ : int [1:5] 18 29 46 56 57
  ..$ : int [1:5] 1 18 29 45 47
  ..$ : int [1:5] 1 20 29 39 46
  ..$ : int [1:5] 8 49 50 54 61
  ..$ : int [1:5] 6 35 48 54 61
  ..$ : int [1:5] 2 8 26 48 61
  ..$ : int [1:5] 3 30 40 41 59
  ..$ : int [1:5] 13 14 20 36 55
  ..$ : int [1:5] 4 8 12 48 54
  ..$ : int [1:5] 8 12 48 49 53
  ..$ : int [1:5] 11 14 20 36 52
  ..$ : int [1:5] 16 18 21 45 57
  ..$ : int [1:5] 18 42 45 46 56
  ..$ : int [1:5] 6 28 35 38 49
  ..$ : int [1:5] 3 30 31 40 44
  ..$ : int [1:5] 2 5 15 19 26
  ..$ : int [1:5] 35 48 49 50 54
  ..- attr(*, "region.id")= chr [1:61] "1" "2" "3" "4" ...
  ..- attr(*, "call")= language knearneigh(x = coords, k = 5)
  ..- attr(*, "sym")= logi FALSE
  ..- attr(*, "type")= chr "knn"
  ..- attr(*, "knn-k")= num 5
  ..- attr(*, "class")= chr "nb"
  ..- attr(*, "ncomp")=List of 2
  .. ..$ nc     : num 1
  .. ..$ comp.id: num [1:61] 1 1 1 1 1 1 1 1 1 1 ...
 $ weights   :List of 61
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..$ : num [1:5] 0.2 0.2 0.2 0.2 0.2
  ..- attr(*, "mode")= chr "binary"
  ..- attr(*, "W")= logi TRUE
  ..- attr(*, "comp")=List of 1
  .. ..$ d: num [1:61] 5 5 5 5 5 5 5 5 5 5 ...
 - attr(*, "class")= chr [1:2] "listw" "nb"
 - attr(*, "region.id")= chr [1:61] "1" "2" "3" "4" ...
 - attr(*, "call")= language nb2listw(neighbours = lyme_knn_nb, style = "W")
 - attr(*, "zero.policy")= logi FALSE</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Distance based</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(nys_lyme_joined))</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="do">## threshold that ensures every point has at least one neighbor</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>dthresh <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">unlist</span>(<span class="fu">nbdists</span>(<span class="fu">dnearneigh</span>(coords, <span class="dv">0</span>, <span class="cn">Inf</span>), coords)))</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="do">## custom threshold 50,000m = 50km</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>d_thresh <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>dist_nb <span class="ot">&lt;-</span> <span class="fu">dnearneigh</span>(coords, <span class="at">d1 =</span> <span class="dv">0</span>,<span class="at">d2 =</span> d_thresh)</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a><span class="co"># d1 = 0: lower bound (exclude self)</span></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a><span class="co"># d2: upper bound (max distance to be considered a neighbor)</span></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>dist_weights <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(dist_nb,<span class="at">style =</span> <span class="st">"W"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dist_nb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 61
 $ : int [1:13] 11 13 14 18 20 29 39 42 45 46 ...
 $ : int [1:9] 5 15 19 26 35 48 50 60 61
 $ : int [1:9] 24 30 31 36 40 41 43 44 59
 $ : int [1:10] 8 9 12 13 27 34 39 48 53 54
 $ : int [1:6] 2 7 15 19 26 60
 $ : int [1:15] 8 9 12 27 28 33 34 35 38 48 ...
 $ : int [1:2] 5 15
 $ : int [1:10] 4 6 12 35 48 49 50 53 54 61
 $ : int [1:11] 4 6 12 13 27 33 34 39 47 53 ...
 $ : int [1:2] 16 17
 $ : int [1:10] 1 14 20 29 40 42 45 46 47 55
 $ : int [1:14] 4 6 8 9 27 33 34 38 39 48 ...
 $ : int [1:10] 1 4 9 20 27 29 39 47 52 55
 $ : int [1:9] 1 11 20 36 40 44 52 55 59
 $ : int [1:8] 2 5 7 19 26 32 37 60
 $ : int [1:5] 10 17 21 56 57
 $ : int [1:2] 10 16
 $ : int [1:13] 1 20 21 22 29 33 39 42 45 46 ...
 $ : int [1:10] 2 5 15 26 28 32 35 37 60 61
 $ : int [1:15] 1 11 13 14 18 29 36 39 40 42 ...
 $ : int [1:9] 16 18 22 25 29 33 45 56 57
 $ : int [1:10] 18 21 25 27 29 33 39 45 46 56
 $ : int [1:3] 25 33 38
 $ : int [1:9] 3 30 31 36 40 41 43 44 59
 $ : int [1:6] 21 22 23 27 33 38
 $ : int [1:13] 2 5 15 19 28 35 37 48 49 50 ...
 $ : int [1:14] 4 6 9 12 13 22 25 33 34 38 ...
 $ : int [1:10] 6 19 26 32 35 37 49 58 60 61
 $ : int [1:15] 1 11 13 18 20 21 22 33 39 42 ...
 $ : int [1:10] 3 24 31 36 40 41 43 44 51 59
 $ : int [1:9] 3 24 30 36 40 41 43 44 59
 $ : int [1:5] 15 19 28 37 60
 $ : int [1:13] 6 9 12 18 21 22 23 25 27 29 ...
 $ : int [1:14] 4 6 9 12 27 33 35 38 48 49 ...
 $ : int [1:15] 2 6 8 19 26 28 34 37 48 49 ...
 $ : int [1:13] 3 14 20 24 30 31 40 41 43 44 ...
 $ : int [1:8] 15 19 26 28 32 35 58 60
 $ : int [1:9] 6 12 23 25 27 33 34 49 58
 $ : int [1:13] 1 4 9 12 13 18 20 22 27 29 ...
 $ : int [1:13] 3 11 14 20 24 30 31 36 41 44 ...
 $ : int [1:9] 3 24 30 31 36 40 43 44 59
 $ : int [1:10] 1 11 18 20 29 45 46 47 56 57
 $ : int [1:8] 3 24 30 31 36 41 44 59
 $ : int [1:12] 3 14 24 30 31 36 40 41 43 52 ...
 $ : int [1:12] 1 11 18 20 21 22 29 42 46 47 ...
 $ : int [1:12] 1 11 18 20 22 29 39 42 45 47 ...
 $ : int [1:12] 1 9 11 13 18 20 29 39 42 45 ...
 $ : int [1:13] 2 4 6 8 12 26 34 35 49 50 ...
 $ : int [1:15] 6 8 12 26 27 28 34 35 38 48 ...
 $ : int [1:10] 2 8 26 35 48 49 53 54 60 61
 $ : int [1:2] 30 59
 $ : int [1:7] 13 14 20 36 40 44 55
 $ : int [1:12] 4 6 8 9 12 27 34 48 49 50 ...
 $ : int [1:13] 4 6 8 9 12 27 34 35 48 49 ...
 $ : int [1:11] 1 11 13 14 20 36 40 44 47 52 ...
 $ : int [1:9] 16 18 21 22 29 42 45 46 57
 $ : int [1:9] 1 16 18 21 29 42 45 46 56
 $ : int [1:9] 6 26 28 34 35 37 38 49 61
 $ : int [1:12] 3 14 24 30 31 36 40 41 43 44 ...
 $ : int [1:11] 2 5 15 19 26 28 32 35 37 50 ...
 $ : int [1:16] 2 6 8 12 19 26 28 34 35 48 ...
 - attr(*, "class")= chr "nb"
 - attr(*, "region.id")= chr [1:61] "1" "2" "3" "4" ...
 - attr(*, "call")= language dnearneigh(x = coords, d1 = 0, d2 = d_thresh)
 - attr(*, "dnn")= num [1:2] 0e+00 1e+05
 - attr(*, "bounds")= chr [1:2] "GE" "LE"
 - attr(*, "nbtype")= chr "distance"
 - attr(*, "sym")= logi TRUE
 - attr(*, "ncomp")=List of 2
  ..$ nc     : num 1
  ..$ comp.id: num [1:61] 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>lyme_IR <span class="ot">&lt;-</span> nys_lyme_joined <span class="sc">|&gt;</span> <span class="fu">pull</span>(Lyme.Incidence.Rate)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>log_lyme_IR <span class="ot">&lt;-</span> <span class="fu">log</span>(lyme_IR)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>lyme_mc <span class="ot">&lt;-</span> <span class="fu">moran.mc</span>(log_lyme_IR,</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">listw =</span> knn_weights,</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nsim =</span> <span class="dv">999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>lyme_mc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  log_lyme_IR 
weights: knn_weights  
number of simulations + 1: 1000 

statistic = 0.69703, observed rank = 1000, p-value = 0.001
alternative hypothesis: greater</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lyme_mc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="variogram_krigging_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(lyme_mc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "statistic"   "parameter"   "p.value"     "alternative" "method"     
[6] "data.name"   "res"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lyme_mc[["res"]]</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>lyme_mc_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">simulated_I =</span> lyme_mc[[<span class="st">"res"</span>]])</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(lyme_mc_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">simulated_I</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.0521171</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0209826</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0101287</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.0631855</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0941063</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0625210</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>observed_I <span class="ot">&lt;-</span> lyme_mc[[<span class="st">"statistic"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>lyme_mc_df <span class="sc">|&gt;</span> </span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> simulated_I))<span class="sc">+</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>)<span class="sc">+</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> observed_I), <span class="at">color =</span> <span class="st">"red"</span>,<span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Monte-carlo Simulation of Moran I"</span>,</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Long Incidence Rate"</span>,</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Observed Moran's I ="</span>, <span class="fu">round</span>(observed_I, <span class="dv">4</span>))</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="variogram_krigging_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(nys_lyme_joined), <span class="at">border =</span> <span class="st">"grey"</span>)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lyme_knn_nb, <span class="at">coords =</span> coords, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="variogram_krigging_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.plot</span>(lyme_IR,</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">listw =</span> knn_weights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="variogram_krigging_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assume lyme_knn_nb is your nb object and coords is a matrix</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>edges <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lyme_knn_nb), <span class="cf">function</span>(i) {</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  neighbors <span class="ot">&lt;-</span> lyme_knn_nb[[i]]</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(neighbors) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> coords[i, <span class="dv">1</span>],</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> coords[i, <span class="dv">2</span>],</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">xend =</span> coords[neighbors, <span class="dv">1</span>],</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">yend =</span> coords[neighbors, <span class="dv">2</span>]</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> nys_lyme_joined, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> edges, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend), </span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">as.data.frame</span>(coords), <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y), </span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="variogram_krigging_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>